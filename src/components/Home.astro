---
import {Image} from "astro:assets";
import meshtastic_logo from "../assets/images/meshtastic_logo.svg"
import config_image from "../assets/images/config.webp"
import AlsaceShape from "./AlsaceShape.astro";

import image1 from "../assets/images/carrousel/1.webp";
import image2 from "../assets/images/carrousel/2.webp";
import image3 from "../assets/images/carrousel/3.webp";
import image4 from "../assets/images/carrousel/4.webp";
import image5 from "../assets/images/carrousel/5.webp";
import image6 from "../assets/images/carrousel/6.webp";
import image7 from "../assets/images/carrousel/7.webp";
import image8 from "../assets/images/carrousel/8.webp";
import {shuffle} from "../utils/ArrayUtils";

const images: { file: any; title: string }[] = shuffle([
    {
        file: image1,
        title: "@ca08"
    },
    {
        file: image3,
        title: "@HKSB"
    },
    {
        file: image7,
        title: "@ari67"
    },
    {
        file: image4,
        title: "@HKSB"
    },
    {
        file: image2,
        title: "@ca08"
    },
    {
        file: image6,
        title: "@FAB1"
    },
    {
        file: image5,
        title: "@F4EGX"
    },
    {
        file: image8,
        title: "@F4MCT"
    }
]);
---

<section id="hero"
         class="font-main w-full h-auto mt-32 flex items-center justify-center gap-10 max-xl:flex-col max-xl:h-auto max-xl:py-12 relative">
    <div class="w-[90%] max-w-[984px]">

        <div class="flex flex-col items-center gap-3 mb-8 text-center">
            <h1 class="mb-4 text-4xl md:text-5xl lg:text-6xl font-extrabold tracking-tight leading-none text-white">
                AlsaMesh</h1>
            <h2 class="text-2xl md:text-3xl lg:text-4xl font-extrabold tracking-tight leading-none text-white">La
                communauté Meshtastic d'Alsace</h2>
            <p class="text-lg font-normal text-gray-400">
                Ensemble, créons un maillage de communication libre et résilient à travers l'Alsace.
            </p>
        </div>


        <div class="flex flex-col mb-8 lg:mb-16 space-y-4 sm:flex-row sm:justify-center sm:space-y-0 sm:space-x-4">
            <a href="https://discord.gg/aRYWN5HwFU"
               target="_blank"
               class="flex justify-center items-center gap-2 py-3 px-5 text-white rounded-lg hover:bg-indigo-800 transition">
                <i class="fab fa-discord"></i>
                Notre Discord
            </a>
            <a href="/equipment"
               class="flex justify-center items-center gap-2 py-3 px-5 text-white rounded-lg border border-neutral-700 hover:bg-neutral-800 transition">
                Notre matériel
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>

    <div class="max-xl:hidden absolute top-0 right-9 z-[-1] mt-[-150px] w-1/3 max-w-lg">
        <AlsaceShape/>
    </div>
</section>

<section id="objectifs"
         class="font-main w-full h-auto flex items-center justify-center gap-10 max-xl:flex-col max-xl:h-auto py-12">
    <div class="w-[90%] max-w-[984px] text-white flex flex-col items-center justify-center font-normal">

        <h3 class="text-3xl mb-12 font-extrabold">Nos objectifs</h3>
        <ul class="space-y-4 list-none pl-0">
            <li class="flex items-center gap-3 bg-neutral-800/50 p-4 rounded-lg hover:bg-neutral-800 transition-all">
                <i class="fas fa-network-wired text-emerald-500"></i>
                <span>Déployer un réseau mesh robuste couvrant l'ensemble du territoire alsacien.</span>
            </li>
            <li class="flex items-center gap-3 bg-neutral-800/50 p-4 rounded-lg hover:bg-neutral-800 transition-all">
                <i class="fas fa-users text-emerald-500"></i>
                <span>Fédérer une communauté active et dynamique autour du projet mesh.</span>
            </li>
            <li class="flex items-center gap-3 bg-neutral-800/50 p-4 rounded-lg hover:bg-neutral-800 transition-all">
                <i class="fas fa-map-pin text-emerald-500"></i>
                <span>Identifier et développer des points stratégiques pour optimiser la couverture du réseau en Alsace.</span>
            </li>
            <li class="flex items-center gap-3 bg-neutral-800/50 p-4 rounded-lg hover:bg-neutral-800 transition-all">
                <i class="fas fa-signal text-emerald-500"></i>
                <span>Privilégier la fréquence 868MHz tout en restant ouvert avec au 433MHz.</span>
            </li>
        </ul>


        <h3 class="text-3xl text-center mt-24 font-extrabold">Vous découvrez Meshtastic ?</h3>
        <div class="mt-8 flex flex-col items-center text-center">
            <p class="text-lg mb-6">Meshtastic est un projet open-source permettant de créer des réseaux de
                communication sans fil longue portée et résilients. Les appareils fonctionnent de manière autonome et
                peuvent former un maillage pour étendre la portée du réseau.</p>
            <p class="text-base mb-8">Découvrez toutes les informations sur le projet, la documentation et les
                ressources
                sur le site officiel :</p>
            <a class="cursor-pointer hover:opacity-90 transition-opacity" href="https://meshtastic.org/"
               target="_blank">
                <Image src={meshtastic_logo} alt="Logo Meshtastic"
                       class="h-[60px] w-auto p-3 rounded-xl custom-shadow bg-gray-50" decoding="async" loading="lazy"
                       width="300" height="100"/>
            </a>
            <p class="text-sm text-gray-400 mt-4 mb-12">meshtastic.org</p>
        </div>

        <h3 class="text-3xl mt-12 font-extrabold">Configuration du node</h3>
        <div class="mt-8 p-8 bg-neutral-900 rounded-xl">
            <div class="flex flex-col gap-3">

                <div class="grid grid-cols-2 gap-2 items-center">
                    <label class="font-medium text-white">Channel Name:</label>
                    <div class="text-gray-400 py-2 px-4 bg-neutral-800 rounded">
                        LongFast
                    </div>

                    <label class="font-medium text-white">Pre-Shared Key (PSK):</label>
                    <div class="text-gray-400 py-2 px-4 bg-neutral-800 rounded">
                        AQ==
                    </div>
                </div>

                <button id="configToggleBtn"
                        class="flex items-center gap-2 py-2 px-4 text-white rounded bg-neutral-800 hover:bg-neutral-700 transition cursor-pointer">
                    <i class="fas fa-qrcode"></i>
                    Afficher le QR-Code de configuration
                </button>
            </div>
        </div>
    </div>
</section>

<section class="flex flex-col items-center justify-center">
    <h3 class="text-3xl mb-8 text-white font-extrabold text-center">Galerie</h3>
    <div class="w-full max-w-6xl shadow-2xl shadow-green-600/10">
        <div class="relative overflow-hidden lg:rounded-xl">
            <div class="flex space-x-3 animate-marquee">
                <!-- Duplicate for marquee effect -->
                {[images, images].flat().map(i => (
                        <div class="flex-shrink-0 relative">
                            <Image src={i.file} alt={i.title} class="h-64 lg:h-96 !w-auto inline-block rounded"/>
                            <div class="absolute bottom-0 left-0 text-white font-semibold m-2 px-2 bg-neutral-900/70 rounded select-none">
                                {i.title}
                            </div>
                        </div>
                ))}
            </div>
        </div>
    </div>
</section>

<div id="configDialog" class="fixed top-0 left-0 w-screen h-screen bg-black/80 z-10 hidden">
    <div class="relative w-full h-full">
        <div class="flex flex-col justify-center items-center gap-2 w-full h-full">
            <Image class="w-1/2 max-w-48"
                   src={config_image} alt="QR Code de confirguration"/>
            <a class="text-gray-500 underline"
               href="https://meshtastic.org/e/#CgMSAQESDwgBOANAA0gBUBtoAcAGAQ"
               target="_blank">
                Ou bien cliquez ici
            </a>
        </div>

        <button class="absolute top-0 right-0 p-2 m-4 rounded-full cursor-pointer text-white bg-neutral-800 active:bg-neutral-900 active:scale-90 transition">
            <i class="fas fa-times"></i>
        </button>
    </div>
</div>

<style>
    #hero {
        background-image: url("../assets/images/background2.svg");
    }

    #objectifs {
        background-image: url("../assets/images/background6.svg");
    }

    @keyframes marquee {
        0% {
            transform: translateX(0);
        }
        100% {
            transform: translateX(-50%);
        }
    }

    .animate-marquee {
        display: flex;
        width: max-content;
        animation: marquee 60s linear infinite;
    }
</style>

<script>
    const configDialog = document.getElementById('configDialog');
    const configToggleBtn = document.getElementById('configToggleBtn');
    const closeDialogBtn = configDialog?.querySelector('button');

    configToggleBtn?.addEventListener('click', () => {
        configDialog?.classList.remove('hidden');
    });

    closeDialogBtn?.addEventListener('click', () => {
        configDialog?.classList.add('hidden');
    });
</script>